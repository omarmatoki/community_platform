# ุฏููู ุงุฎุชุจุงุฑ ุงููุธุงู ุนูู Postman

## ๐ ุงูุฅุนุฏุงุฏ ุงูุฃููู

### 1. ุฑุจุท WhatsApp (ุฎุทูุฉ ูุงุญุฏุฉ ููุท - ุฃูู ูุฑุฉ)

ูู ุงูุทุฑููุฉุ ูู ุจุชุดุบูู:
```bash
npm run init-whatsapp
```

**ุณูุธูุฑ:**
- ุฑูุฒ QR ูู ุงูุทุฑููุฉ
- ุงูุชุญ WhatsApp ุนูู ูุงุชูู
- ุงุฐูุจ ุฅูู: **ุงูุฅุนุฏุงุฏุงุช** โ **ุงูุฃุฌูุฒุฉ ุงููุฑุชุจุทุฉ** โ **ุฑุจุท ุฌูุงุฒ**
- ุงูุณุญ ุงูุฑูุฒ
- ุงูุชุธุฑ ุญุชู ุชุฑู: `โ WhatsApp ูุชุตู ูุฌุงูุฒ ููุฅุฑุณุงู!`

### 2. ุชุดุบูู ุงูุณูุฑูุฑ

```bash
npm run dev
```

---

## ๐ฌ ุงุฎุชุจุงุฑ API ุนูู Postman

### ุงูุณููุงุฑูู 1๏ธโฃ: ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ

#### ุงูุฎุทูุฉ 1: ุฅุฑุณุงู OTP

**ุฅุนุฏุงุฏุงุช Postman:**
- **Method:** `POST`
- **URL:** `http://localhost:4001/api/auth/send-otp`
- **Headers:**
  ```
  Content-Type: application/json
  ```
- **Body (raw - JSON):**
  ```json
  {
    "phoneNumber": "0512345678"
  }
  ```

**ุงููุฑ ุนูู Send**

**ุงูุงุณุชุฌุงุจุฉ ุงููุชููุนุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู ุฅูู ุฑูู ุงููุงุชุณุงุจ ุงูุฎุงุต ุจู",
  "data": {
    "phoneNumber": "0512345678",
    "expiresIn": "10 ุฏูุงุฆู"
  }
}
```

**โ ุงูุขู:**
- ุงูุชุญ WhatsApp ุนูู ูุงุชูู
- ุณุชุณุชูู ุฑุณุงูุฉ ุชุญุชูู ุนูู ุฑูุฒ ูู 6 ุฃุฑูุงู ูุซู: `123456`
- ุงุญูุธ ูุฐุง ุงูุฑูุฒ

---

#### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู OTP ูุงูุชุณุฌูู

**ุฅุนุฏุงุฏุงุช Postman:**
- **Method:** `POST`
- **URL:** `http://localhost:4001/api/auth/verify-otp`
- **Headers:**
  ```
  Content-Type: application/json
  ```
- **Body (raw - JSON):**
  ```json
  {
    "phoneNumber": "0512345678",
    "code": "123456",
    "name": "ุฃุญูุฏ ูุญูุฏ"
  }
  ```

โ๏ธ **ูุงู:** ุงุณุชุจุฏู `"123456"` ุจุงูุฑูุฒ ุงูุฐู ุงุณุชููุชู ุนูู WhatsApp

**ุงููุฑ ุนูู Send**

**ุงูุงุณุชุฌุงุจุฉ ุงููุชููุนุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุงูุชุณุฌูู ุจูุฌุงุญ",
  "data": {
    "user": {
      "id": "uuid-here",
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "phoneNumber": "0512345678",
      "points": 0,
      "role": "user",
      "isPhoneVerified": true
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**โ ุงุญูุธ ุงูู `token`** - ุณุชุญุชุงุฌู ููุทูุจุงุช ุงููุญููุฉ

---

### ุงูุณููุงุฑูู 2๏ธโฃ: ุชุณุฌูู ุฏุฎูู ูุณุชุฎุฏู ููุฌูุฏ

#### ุงูุฎุทูุฉ 1: ุฅุฑุณุงู OTP

ููุณ ุงูุฎุทูุฉ ุงูุณุงุจูุฉ - ุฃุฑุณู ุฑูู ุงููุงุชู:

**Body:**
```json
{
  "phoneNumber": "0512345678"
}
```

#### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู OTP (ุจุฏูู name)

**Body:**
```json
{
  "phoneNumber": "0512345678",
  "code": "654321"
}
```

โ๏ธ **ุงููุฑู:** ูุง ุชุญุชุงุฌ ูุฅุฑุณุงู `name` ูุฃู ุงููุณุชุฎุฏู ููุฌูุฏ ุจุงููุนู

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ",
  "data": {
    "user": {...},
    "token": "new-jwt-token-here"
  }
}
```

---

### ุงูุณููุงุฑูู 3๏ธโฃ: ุฅุนุงุฏุฉ ุฅุฑุณุงู OTP

ุฅุฐุง ุงูุชูุช ุตูุงุญูุฉ ุงูุฑูุฒ ุฃู ูู ูุตู:

**ุฅุนุฏุงุฏุงุช Postman:**
- **Method:** `POST`
- **URL:** `http://localhost:4001/api/auth/resend-otp`
- **Headers:**
  ```
  Content-Type: application/json
  ```
- **Body:**
  ```json
  {
    "phoneNumber": "0512345678"
  }
  ```

โ๏ธ **ููุงุญุธุฉ:** ูุฌุจ ุงูุงูุชุธุงุฑ ุฏูููุชูู ุจูู ูู ุฅุฑุณุงู

**ุฅุฐุง ุญุงููุช ูุจู ุฏูููุชูู:**
```json
{
  "success": false,
  "message": "ูุฑุฌู ุงูุงูุชุธุงุฑ 45 ุซุงููุฉ ูุจู ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู"
}
```

---

### ุงูุณููุงุฑูู 4๏ธโฃ: ุงูุญุตูู ุนูู ุงูููู ุงูุดุฎุตู (Authenticated)

**ุฅุนุฏุงุฏุงุช Postman:**
- **Method:** `GET`
- **URL:** `http://localhost:4001/api/auth/profile`
- **Headers:**
  ```
  Content-Type: application/json
  Authorization: Bearer YOUR_JWT_TOKEN_HERE
  ```

โ๏ธ ุงุณุชุจุฏู `YOUR_JWT_TOKEN_HERE` ุจุงูู token ุงูุฐู ุญุตูุช ุนููู ูู ุงูุชุณุฌูู/ุชุณุฌูู ุงูุฏุฎูู

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "name": "ุฃุญูุฏ ูุญูุฏ",
    "phoneNumber": "0512345678",
    "points": 0,
    "role": "user",
    "isPhoneVerified": true,
    "createdAt": "2024-01-01T00:00:00.000Z",
    "updatedAt": "2024-01-01T00:00:00.000Z"
  }
}
```

---

### ุงูุณููุงุฑูู 5๏ธโฃ: ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู

**ุฅุนุฏุงุฏุงุช Postman:**
- **Method:** `PUT`
- **URL:** `http://localhost:4001/api/auth/profile`
- **Headers:**
  ```
  Content-Type: application/json
  Authorization: Bearer YOUR_JWT_TOKEN_HERE
  ```
- **Body:**
  ```json
  {
    "name": "ุฃุญูุฏ ูุญูุฏ ุงูุนูู"
  }
  ```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู ุจูุฌุงุญ",
  "data": {
    "id": "uuid",
    "name": "ุฃุญูุฏ ูุญูุฏ ุงูุนูู",
    "phoneNumber": "0512345678",
    ...
  }
}
```

---

### ุงูุณููุงุฑูู 6๏ธโฃ: ุชุญุฏูุซ ุฑูู ุงููุงุชู

#### ุงูุฎุทูุฉ 1: ุฅุฑุณุงู OTP ููุฑูู ุงูุฌุฏูุฏ

```json
{
  "phoneNumber": "0598765432"
}
```

#### ุงูุฎุทูุฉ 2: ุชุญุฏูุซ ุงูุฑูู ูุน ุงูุชุญูู

**ุฅุนุฏุงุฏุงุช Postman:**
- **Method:** `PUT`
- **URL:** `http://localhost:4001/api/auth/update-phone`
- **Headers:**
  ```
  Content-Type: application/json
  Authorization: Bearer YOUR_JWT_TOKEN_HERE
  ```
- **Body:**
  ```json
  {
    "newPhoneNumber": "0598765432",
    "code": "789456"
  }
  ```

---

## ๐จ ุฅูุดุงุก Collection ูู Postman

### ุฎุทูุงุช ุฅูุดุงุก Collection ููุธูุฉ:

1. **ูู Postmanุ ุงููุฑ ุนูู:**
   - `Collections` โ `+` (New Collection)
   - ุงุณู Collection: `WhatsApp Auth System`

2. **ุฃุถู ุงููุฌูุฏุงุช ุงูุชุงููุฉ:**
   - ๐ `Public - Authentication`
   - ๐ `Protected - User Profile`

3. **ูู ูุฌูุฏ Public:**
   - ุฃุถู: `Send OTP`
   - ุฃุถู: `Resend OTP`
   - ุฃุถู: `Verify OTP`

4. **ูู ูุฌูุฏ Protected:**
   - ุฃุถู: `Get Profile`
   - ุฃุถู: `Update Profile`
   - ุฃุถู: `Update Phone Number`

5. **ุฅุนุฏุงุฏ ูุชุบูุฑุงุช Collection:**
   - ุงููุฑ ุนูู Collection โ `Variables`
   - ุฃุถู:
     ```
     baseUrl: http://localhost:4001
     token: (ุณูุชู ุชุนุจุฆุชู ุชููุงุฆูุงู)
     ```

6. **ุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช:**
   - URL: `{{baseUrl}}/api/auth/send-otp`
   - Authorization: `Bearer {{token}}`

---

## ๐งช ุณููุงุฑูู ุงุฎุชุจุงุฑ ูุงูู

### ุงุฎุชุจุงุฑ ุงูุชุฏูู ุงููุงูู:

```
1. ุฅุฑุณุงู OTP
   โ
2. ูุญุต WhatsApp
   โ
3. ุงูุชุญูู ูู OTP (ุชุณุฌูู)
   โ
4. ุญูุธ Token
   โ
5. ุงูุญุตูู ุนูู ุงูููู ุงูุดุฎุตู
   โ
6. ุชุญุฏูุซ ุงูุงุณู
   โ
7. ุฅุฑุณุงู OTP ูุฑูู ุฌุฏูุฏ
   โ
8. ุชุญุฏูุซ ุฑูู ุงููุงุชู
   โ
9. ุชุณุฌูู ุงูุฎุฑูุฌ
   โ
10. ุฅุฑุณุงู OTP ููุฑูู ุงูุฌุฏูุฏ
    โ
11. ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฑูู ุงูุฌุฏูุฏ
```

---

## โ ุฃุฎุทุงุก ุดุงุฆุนุฉ ูุญููููุง

### 1. ุฎุทุฃ: `WhatsApp ุบูุฑ ูุชุงุญุฉ ุญุงููุงู`

**ุงูุญู:**
```bash
npm run init-whatsapp
```

### 2. ุฎุทุฃ: `ุฑูู ุงููุงุชู ุบูุฑ ุตุงูุญ`

**ุงูุณุจุจ:** ุชูุณูู ุงูุฑูู ุฎุงุทุฆ

**ุงูุชูุณููุงุช ุงูุตุญูุญุฉ:**
- โ `0512345678`
- โ `+966512345678`
- โ `966512345678`
- โ `00966512345678`

**ุงูุชูุณููุงุช ุงูุฎุงุทุฆุฉ:**
- โ `512345678` (ุจุฏูู 0)
- โ `05-1234-5678` (ุจู ุดุฑุทุงุช)
- โ `05 123 456 78` (ุจู ูุณุงูุงุช)

### 3. ุฎุทุฃ: `ุฑูุฒ ุงูุชุญูู ุบูุฑ ุตุญูุญ`

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ุงูุฑูุฒ ููุชูู ุงูุตูุงุญูุฉ (ุฃูุซุฑ ูู 10 ุฏูุงุฆู)
- ุงูุฑูุฒ ุฎุงุทุฆ
- ุชู ุงุณุชุฎุฏุงู 5 ูุญุงููุงุช

**ุงูุญู:** ุงุทูุจ ุฅุนุงุฏุฉ ุฅุฑุณุงู OTP

### 4. ุฎุทุฃ: `ูุฑุฌู ุงูุงูุชุธุงุฑ X ุซุงููุฉ`

**ุงูุณุจุจ:** ุญุงููุช ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู ูุจู ูุฑูุฑ ุฏูููุชูู

**ุงูุญู:** ุงูุชุธุฑ ุงูููุช ุงููุญุฏุฏ

### 5. ุฎุทุฃ: `Unauthorized`

**ุงูุณุจุจ:** Token ุบูุฑ ุตุญูุญ ุฃู ููุชูู

**ุงูุญู:**
- ุชุฃูุฏ ูู ูุฌูุฏ `Authorization: Bearer TOKEN` ูู Headers
- ุชุฃูุฏ ูู ุตุญุฉ ุงูู Token
- ุณุฌู ุฏุฎูู ุฌุฏูุฏ ุฅุฐุง ุงูุชูู ุงูู Token

---

## ๐ ุฃูุซูุฉ Responses

### โ Success Response
```json
{
  "success": true,
  "message": "ุฑุณุงูุฉ ุงููุฌุงุญ",
  "data": {...}
}
```

### โ Error Response
```json
{
  "success": false,
  "message": "ุฑุณุงูุฉ ุงูุฎุทุฃ"
}
```

### โ Validation Error
```json
{
  "success": false,
  "errors": [
    {
      "msg": "ุฑูู ุงููุงุชู ุบูุฑ ุตุงูุญ",
      "param": "phoneNumber",
      "location": "body"
    }
  ]
}
```

---

## ๐ง ูุตุงุฆุญ ูููุฏุฉ ูู Postman

### 1. ุญูุธ Token ุชููุงุฆูุงู ุจุนุฏ ุงูุชุณุฌูู:

ูู ุชุจููุจ `Tests` ูุทูุจ `Verify OTP`:
```javascript
if (pm.response.code === 200) {
    var jsonData = pm.response.json();
    if (jsonData.success && jsonData.data.token) {
        pm.collectionVariables.set("token", jsonData.data.token);
    }
}
```

### 2. Pre-request Script ููู timestamp:

```javascript
pm.collectionVariables.set("timestamp", Date.now());
```

### 3. ุงุณุชุฎุฏุงู Environment:

ุฃูุดุฆ Environment ุจุงููุชุบูุฑุงุช:
```
baseUrl: http://localhost:4001
phoneNumber: 0512345678
token: (auto-filled)
```

---

## ๐ Checklist ููุงุฎุชุจุงุฑ

- [ ] ุฑุจุท WhatsApp ุจูุฌุงุญ
- [ ] ุชุดุบูู ุงูุณูุฑูุฑ
- [ ] ุฅุฑุณุงู OTP ูุฑูู ุฌุฏูุฏ
- [ ] ุงุณุชูุงู ุงูุฑุณุงูุฉ ุนูู WhatsApp
- [ ] ุงูุชุณุฌูู ุจูุฌุงุญ
- [ ] ุงูุญุตูู ุนูู Token
- [ ] ุงูุญุตูู ุนูู ุงูููู ุงูุดุฎุตู
- [ ] ุชุญุฏูุซ ุงูุงุณู
- [ ] ุฅุนุงุฏุฉ ุฅุฑุณุงู OTP
- [ ] ุชุญุฏูุซ ุฑูู ุงููุงุชู
- [ ] ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฑูู ุงูุฌุฏูุฏ
- [ ] ุงุฎุชุจุงุฑ ุงูุฃุฎุทุงุก (ุฑูุฒ ุฎุงุทุฆุ ุฑูู ุบูุฑ ุตุงูุญุ ุฅูุฎ)

---

## ๐ฏ ูุตุงุฆุญ ุฅุถุงููุฉ

1. **ุงุณุชุฎุฏู ุฑูู WhatsApp ุญูููู ููุงุฎุชุจุงุฑ**
2. **ุงุญุชูุธ ุจู Collection ูุญููุธุฉ ูู Postman**
3. **ุงุฎุชุจุฑ ุฌููุน ุงูุณููุงุฑูููุงุช (Success ู Error)**
4. **ุฑุงูุจ console ุงูุณูุฑูุฑ ููุฃุฎุทุงุก**
5. **ุชุฃูุฏ ูู ุจูุงุก WhatsApp ูุชุตู**

---

**ุฌุงูุฒ ููุงุฎุชุจุงุฑ! ๐**
