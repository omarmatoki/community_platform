# ุฏููู API ุงูููุงุฆู - ูุธุงู ุงูุชูุซูู ุจู OTP ููููุฉ ุงููุฑูุฑ

## ๐ ูุธุงู ุงูุชูุซูู ุงููุฒุฏูุฌ

ุงููุธุงู ุงูุขู ูุณุชุฎุฏู **ุทุจูุชูู ูู ุงูุฃูุงู**:
1. **OTP ุนุจุฑ WhatsApp** - ููุชุญูู ูู ุฑูู ุงููุงุชู
2. **ูููุฉ ุงููุฑูุฑ** - ููุญูุงูุฉ ุงูุฅุถุงููุฉ

---

## ๐ฑ ุงูุชุณุฌูู (Register)

### ุงูุฎุทูุฉ 1๏ธโฃ: ุฅุฑุณุงู OTP ููุชุณุฌูู

**Endpoint:** `POST /api/auth/register/send-otp`

**Request Body:**
```json
{
  "phoneNumber": "+963998107722",
  "name": "ุฃุญูุฏ ูุญูุฏ"
}
```

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู ุฅูู ุฑูู ุงููุงุชุณุงุจ ุงูุฎุงุต ุจู",
  "data": {
    "phoneNumber": "+963998107722",
    "expiresIn": "10 ุฏูุงุฆู"
  }
}
```

---

### ุงูุฎุทูุฉ 2๏ธโฃ: ุงูุชุญูู ูู OTP ูุฅุชูุงู ุงูุชุณุฌูู

**Endpoint:** `POST /api/auth/register/verify-otp`

**Request Body:**
```json
{
  "phoneNumber": "+963998107722",
  "code": "123456",
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "password": "mySecurePassword123"
}
```

**ุงูุจูุงูุงุช ุงููุทููุจุฉ:**
- `phoneNumber` - ุฑูู ุงููุงุชู ุจุงูุตูุบุฉ ุงูุฏูููุฉ
- `code` - ุฑูุฒ OTP ุงููุณุชูู ุนูู WhatsApp (6 ุฃุฑูุงู)
- `name` - ุงุณู ุงููุณุชุฎุฏู (2-100 ุญุฑู)
- `password` - ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู)

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุงูุชุณุฌูู ุจูุฌุงุญ",
  "data": {
    "user": {
      "id": "uuid-here",
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "phoneNumber": "+963998107722",
      "points": 0,
      "role": "user",
      "isPhoneVerified": true
    },
    "token": "jwt-token-here"
  }
}
```

---

## ๐ ุชุณุฌูู ุงูุฏุฎูู (Login)

### ุงูุฎุทูุฉ 1๏ธโฃ: ุฅุฑุณุงู OTP ูุชุณุฌูู ุงูุฏุฎูู

**Endpoint:** `POST /api/auth/login/send-otp`

**Request Body:**
```json
{
  "phoneNumber": "+963998107722"
}
```

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุฅุฑุณุงู ุฑูุฒ ุงูุชุญูู ุฅูู ุฑูู ุงููุงุชุณุงุจ ุงูุฎุงุต ุจู",
  "data": {
    "phoneNumber": "+963998107722",
    "expiresIn": "10 ุฏูุงุฆู"
  }
}
```

---

### ุงูุฎุทูุฉ 2๏ธโฃ: ุงูุชุญูู ูู OTP ูุชุณุฌูู ุงูุฏุฎูู

**Endpoint:** `POST /api/auth/login/verify-otp`

**Request Body:**
```json
{
  "phoneNumber": "+963998107722",
  "code": "654321",
  "password": "mySecurePassword123"
}
```

**ุงูุจูุงูุงุช ุงููุทููุจุฉ:**
- `phoneNumber` - ุฑูู ุงููุงุชู
- `code` - ุฑูุฒ OTP (6 ุฃุฑูุงู)
- `password` - ูููุฉ ุงููุฑูุฑ

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ",
  "data": {
    "user": {
      "id": "uuid-here",
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "phoneNumber": "+963998107722",
      "points": 150,
      "role": "user",
      "isPhoneVerified": true
    },
    "token": "jwt-token-here"
  }
}
```

---

## ๐ ุณูุฑ ุงูุนูู ุงููุงูู

### ุงูุชุณุฌูู:
```
1. ุงููุณุชุฎุฏู ูุฏุฎู:
   - ุฑูู ุงููุงุชู (+963998107722)
   - ุงูุงุณู (ุฃุญูุฏ ูุญูุฏ)
   โ
2. Frontend โ POST /api/auth/register/send-otp
   โ
3. Backend โ ุฅุฑุณุงู OTP ุนุจุฑ WhatsApp
   โ
4. ุงููุณุชุฎุฏู ูุณุชูู ุงูุฑูุฒ ุนูู WhatsApp (123456)
   โ
5. ุงููุณุชุฎุฏู ูุฏุฎู:
   - ุฑูู ุงููุงุชู
   - ุงูุฑูุฒ (123456)
   - ุงูุงุณู
   - ูููุฉ ุงููุฑูุฑ (mySecurePassword123)
   โ
6. Frontend โ POST /api/auth/register/verify-otp
   โ
7. Backend โ ุงูุชุญูู ูู OTP
   โ
8. Backend โ ุญูุธ ูููุฉ ุงููุฑูุฑ (ูุดูุฑุฉ)
   โ
9. Backend โ ุฅูุดุงุก ุงูุญุณุงุจ
   โ
10. Backend โ ุฅุฑุฌุงุน Token
```

### ุชุณุฌูู ุงูุฏุฎูู:
```
1. ุงููุณุชุฎุฏู ูุฏุฎู ุฑูู ุงููุงุชู
   โ
2. Frontend โ POST /api/auth/login/send-otp
   โ
3. Backend โ ุฅุฑุณุงู OTP ุนุจุฑ WhatsApp
   โ
4. ุงููุณุชุฎุฏู ูุณุชูู ุงูุฑูุฒ ุนูู WhatsApp (654321)
   โ
5. ุงููุณุชุฎุฏู ูุฏุฎู:
   - ุฑูู ุงููุงุชู
   - ุงูุฑูุฒ (654321)
   - ูููุฉ ุงููุฑูุฑ (mySecurePassword123)
   โ
6. Frontend โ POST /api/auth/login/verify-otp
   โ
7. Backend โ ุงูุชุญูู ูู ูููุฉ ุงููุฑูุฑ
   โ
8. Backend โ ุงูุชุญูู ูู OTP
   โ
9. Backend โ ุฅุฑุฌุงุน Token
```

---

## ๐งช ุงุฎุชุจุงุฑ ุนูู Postman

### ูุซุงู 1: ุชุณุฌูู ูุณุชุฎุฏู ุณูุฑู

#### ุงูุฎุทูุฉ 1: ุทูุจ OTP
```
POST http://localhost:4001/api/auth/register/send-otp

Headers:
Content-Type: application/json

Body:
{
  "phoneNumber": "+963998107722",
  "name": "ูุญูุฏ ุงูุฃุญูุฏ"
}
```

#### ุงูุฎุทูุฉ 2: ุงูุญุต WhatsApp
ุณุชุณุชูู ุฑุณุงูุฉ ูุซู:
```
ูุฑุญุจุงู! ๐

ุฑูุฒ ุงูุชุญูู ุงูุฎุงุต ุจู ูู: *123456*

ูุฐุง ุงูุฑูุฒ ุตุงูุญ ููุฏุฉ 10 ุฏูุงุฆู.

โ๏ธ ูุง ุชุดุงุฑู ูุฐุง ุงูุฑูุฒ ูุน ุฃู ุดุฎุต.

โจ ููุตุฉ ุตูุชูุง ูุจูู
```

#### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูุงูุชุณุฌูู
```
POST http://localhost:4001/api/auth/register/verify-otp

Headers:
Content-Type: application/json

Body:
{
  "phoneNumber": "+963998107722",
  "code": "123456",
  "name": "ูุญูุฏ ุงูุฃุญูุฏ",
  "password": "Syria@2024"
}
```

---

### ูุซุงู 2: ุชุณุฌูู ุฏุฎูู

#### ุงูุฎุทูุฉ 1: ุทูุจ OTP
```
POST http://localhost:4001/api/auth/login/send-otp

Headers:
Content-Type: application/json

Body:
{
  "phoneNumber": "+963998107722"
}
```

#### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูุชุณุฌูู ุงูุฏุฎูู
```
POST http://localhost:4001/api/auth/login/verify-otp

Headers:
Content-Type: application/json

Body:
{
  "phoneNumber": "+963998107722",
  "code": "654321",
  "password": "Syria@2024"
}
```

---

## โ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ

### 1. ูููุฉ ูุฑูุฑ ูุตูุฑุฉ
```json
{
  "success": false,
  "message": "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชููู 6 ุฃุญุฑู ุนูู ุงูุฃูู"
}
```

### 2. ูููุฉ ูุฑูุฑ ุฎุงุทุฆุฉ ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
```json
{
  "success": false,
  "message": "ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ"
}
```

### 3. ุจูุงูุงุช ูุงูุตุฉ
```json
{
  "success": false,
  "message": "ุฑูู ุงููุงุชูุ ุฑูุฒ ุงูุชุญููุ ููููุฉ ุงููุฑูุฑ ูุทููุจุฉ"
}
```

### 4. OTP ุฎุงุทุฆ
```json
{
  "success": false,
  "message": "ุฑูุฒ ุงูุชุญูู ุบูุฑ ุตุญูุญ. ุงููุญุงููุงุช ุงููุชุจููุฉ: 4"
}
```

---

## ๐ ุงูุฃูุงู

### ุทุจูุงุช ุงูุญูุงูุฉ:
1. **OTP ุนุจุฑ WhatsApp:**
   - ุตุงูุญ ููุฏุฉ 10 ุฏูุงุฆู ููุท
   - ุญุฏ ุฃูุตู 5 ูุญุงููุงุช ุฎุงุทุฆุฉ
   - ููุญุฐู ุจุนุฏ ุงูุงุณุชุฎุฏุงู

2. **ูููุฉ ุงููุฑูุฑ:**
   - ูุดูุฑุฉ ุจุงุณุชุฎุฏุงู bcrypt
   - ุญุฏ ุฃุฏูู 6 ุฃุญุฑู
   - ูุฎุฒูุฉ ุจุดูู ุขูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

3. **JWT Token:**
   - ุตุงูุญ ููุฏุฉ 7 ุฃูุงู (ูุงุจู ููุชุนุฏูู)
   - ูุดูุฑ ููุญุชูู ุนูู ID ุงููุณุชุฎุฏู ููุท

### ุนูููุฉ ุงูุชุณุฌูู:
```
OTP ุตุญูุญ + ูููุฉ ุงููุฑูุฑ = ุญุณุงุจ ุฌุฏูุฏ
```

### ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู:
```
OTP ุตุญูุญ + ูููุฉ ุงููุฑูุฑ ุตุญูุญุฉ = ุชุณุฌูู ุฏุฎูู ูุงุฌุญ
```

---

## ๐ ุฃูุซูุฉ ุฏูููุฉ

### ุณูุฑูุง
```json
{
  "phoneNumber": "+963998107722",
  "password": "Syria@2024"
}
```

### ุงูุณุนูุฏูุฉ
```json
{
  "phoneNumber": "+966512345678",
  "password": "Saudi@2024"
}
```

### ูุตุฑ
```json
{
  "phoneNumber": "+201234567890",
  "password": "Egypt@2024"
}
```

### ุงูุฅูุงุฑุงุช
```json
{
  "phoneNumber": "+971501234567",
  "password": "UAE@2024"
}
```

---

## ๐ ููุฎุต Endpoints

| Endpoint | Method | ุงููุตู | ุงููุฏุฎูุงุช ุงููุทููุจุฉ |
|----------|--------|-------|-------------------|
| `/api/auth/register/send-otp` | POST | ุฅุฑุณุงู OTP ููุชุณุฌูู | phoneNumber, name |
| `/api/auth/register/verify-otp` | POST | ุงูุชุญูู ูุงูุชุณุฌูู | phoneNumber, code, name, password |
| `/api/auth/login/send-otp` | POST | ุฅุฑุณุงู OTP ููุฏุฎูู | phoneNumber |
| `/api/auth/login/verify-otp` | POST | ุงูุชุญูู ูุงูุฏุฎูู | phoneNumber, code, password |
| `/api/auth/resend-otp` | POST | ุฅุนุงุฏุฉ ุฅุฑุณุงู OTP | phoneNumber |
| `/api/auth/profile` | GET | ุงูููู ุงูุดุฎุตู | Bearer Token |
| `/api/auth/profile` | PUT | ุชุญุฏูุซ ุงูููู | Bearer Token, name |
| `/api/auth/update-phone` | PUT | ุชุญุฏูุซ ุงูุฑูู | Bearer Token, newPhoneNumber, code |

---

## โ๏ธ ุงูุฅุนุฏุงุฏ

```bash
# 1. ุฑุจุท WhatsApp
npm run init-whatsapp

# 2. ุชุดุบูู ุงูุณูุฑูุฑ
npm run dev
```

---

**ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

ุงูุขู ูุฏูู ูุธุงู ุชูุซูู ุขูู ุจุทุจูุชูู:
- โ OTP ุนุจุฑ WhatsApp
- โ ูููุฉ ุงููุฑูุฑ
